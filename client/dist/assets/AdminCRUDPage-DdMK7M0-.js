import{u as X,r as u,j as s,a as b}from"./index-pB9rXeLh.js";function Z({title:B,apiEndpoint:w,endpointPath:R=null,responseKey:E=null,updateEndpointPath:L=null,deleteEndpointPath:T=null,fields:I,initialForm:p={},disableCreate:g=!1,fileUploadField:K=null,listTransform:M=i=>i,formTransform:O=i=>i,customCreateHandler:D=null,onEdit:y=null,renderItemActions:$=null,onFormChange:t=null,onAfterSubmit:j=null,onCancelEdit:h=null}){const{token:i}=X(),[P,q]=u.useState([]),[x,N]=u.useState(null),[o,n]=u.useState(p),[S,k]=u.useState(!1),[U,r]=u.useState(""),m=R||w,A=E||w,z=L||m,G=T||m,v=async()=>{try{const e=await b(`/api/admin/${m}`,{token:i}),a=Array.isArray(e==null?void 0:e[A])?e[A]:Array.isArray(e)?e:[];q(a.map(M))}catch(e){r((e==null?void 0:e.message)||"Failed to load")}};u.useEffect(()=>{v()},[m]);const J=async e=>{e.preventDefault(),k(!0),r("");try{const a=O(o);x?(await b(`/api/admin/${z}/${x.id}`,{token:i,method:"PUT",body:a}),r("Updated")):(D?await D(a):await b(`/api/admin/${m}`,{token:i,method:"POST",body:a}),r("Created")),n(p),N(null),v(),j==null||j()}catch(a){r((a==null?void 0:a.message)||"Failed")}finally{k(!1)}},Q=e=>{N(e),n(()=>{const a=e,l=t==null?void 0:t(a);return l&&typeof l=="object"?l:a}),y==null||y(e)},V=async e=>{if(confirm("Delete this item?"))try{await b(`/api/admin/${G}/${e}`,{token:i,method:"DELETE"}),r("Deleted"),v()}catch(a){r((a==null?void 0:a.message)||"Failed")}},W=e=>{const a=e.target.files[0];if(!a)return;const l=new FileReader;l.onloadend=()=>{n(d=>{const c={...d,[K]:l.result},f=t==null?void 0:t(c,d);return f&&typeof f=="object"?f:c})},l.readAsDataURL(a)};return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card overflow-hidden",children:s.jsx("div",{className:"card-body bg-gradient-to-r from-primary-50 via-white to-secondary-50",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"font-display text-xl font-semibold",children:B}),s.jsx("div",{className:"mt-1 text-sm text-slate-700",children:"Create, update and manage items safely."})]}),s.jsx("span",{className:"badge",children:"⚙️ Admin"})]})})}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{className:"font-display text-base font-semibold",children:x||g?"Edit item":"Create new"})}),s.jsxs("div",{className:"card-body",children:[U&&s.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-secondary-50 p-3 text-sm text-slate-800 mb-4",children:U}),g&&!x?s.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-white p-4 text-sm text-slate-700",children:"Select an item below and click Edit."}):s.jsxs("form",{onSubmit:J,className:"space-y-4",children:[s.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:I.map(e=>s.jsxs("div",{className:e.type==="textarea"||e.type==="file"?"sm:col-span-2":"",children:[s.jsx("div",{className:"label",children:e.label}),e.type==="textarea"?s.jsx("textarea",{className:"input",disabled:!!e.disabled,placeholder:e.placeholder,value:o[e.name]||"",onChange:a=>n(l=>{const d={...l,[e.name]:a.target.value},c=t==null?void 0:t(d,l);return c&&typeof c=="object"?c:d}),rows:3}):e.type==="file"?s.jsx("input",{type:"file",className:"input",disabled:!!e.disabled,onChange:W,accept:e.accept}):e.type==="select"?s.jsx("select",{className:"input",disabled:!!e.disabled,value:o[e.name]||"",onChange:a=>n(l=>{const d={...l,[e.name]:a.target.value},c=t==null?void 0:t(d,l);return c&&typeof c=="object"?c:d}),children:e.options.map(a=>s.jsx("option",{value:a.value,children:a.label},a.value))}):s.jsx("input",{type:e.type||"text",className:"input",disabled:!!e.disabled,placeholder:e.placeholder,value:o[e.name]||"",onChange:a=>n(l=>{const d={...l,[e.name]:a.target.value},c=t==null?void 0:t(d,l);return c&&typeof c=="object"?c:d})})]},e.name))}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"submit",disabled:S,className:"btn-primary",children:S?"Saving...":x?"Update":"Create"}),x&&s.jsx("button",{type:"button",onClick:()=>{N(null),n(()=>{const e=p,a=t==null?void 0:t(e);return a&&typeof a=="object"?a:e}),h==null||h()},className:"btn-ghost",children:"Cancel"})]})]})]})]}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"card-header",children:s.jsx("h3",{className:"font-display text-base font-semibold",children:"Items"})}),s.jsx("div",{className:"card-body",children:P.length===0?s.jsx("div",{className:"rounded-2xl border border-slate-200/70 bg-white p-4 text-sm text-slate-700",children:"No items yet."}):s.jsx("div",{className:"space-y-3",children:P.map(e=>s.jsxs("div",{className:"card overflow-hidden",children:[s.jsx("div",{className:"h-1 bg-gradient-to-r from-primary-500 to-secondary-500"}),s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-semibold text-slate-900",children:e.title||e.name||e.id}),e.subject&&s.jsx("div",{className:"mt-1 text-xs text-slate-600",children:e.subject}),e.status&&s.jsx("div",{className:"mt-2",children:s.jsx("span",{className:`badge ${e.status==="active"?"badge-success":""}`,children:e.status})})]}),s.jsxs("div",{className:"flex gap-2",children:[$?$(e):null,s.jsx("button",{onClick:()=>Q(e),className:"btn-ghost text-xs",children:"Edit"}),s.jsx("button",{onClick:()=>V(e.id),className:"btn-ghost text-xs text-red-600",children:"Delete"})]})]})})]},e.id))})})]})]})}export{Z as A};
