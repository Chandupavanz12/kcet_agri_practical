import{u as k,r as o,j as e,a as h}from"./index-pB9rXeLh.js";const F=["ðŸ“Š","ðŸ—‚ï¸","ðŸ‘¥","ðŸ“","ðŸŽ¬","ðŸ“š","ðŸ“‹","ðŸ””","âš™ï¸","ðŸ“ˆ","ðŸ‘¤","â“","ðŸšª","ðŸ“„"],w=[{value:"/student/dashboard",label:"/student/dashboard"},{value:"/student/tests",label:"/student/tests"},{value:"/student/progress",label:"/student/progress"},{value:"/student/results",label:"/student/results"},{value:"/student/videos",label:"/student/videos"},{value:"/student/materials",label:"/student/materials"},{value:"/student/pyqs",label:"/student/pyqs"},{value:"/student/notifications",label:"/student/notifications"},{value:"/student/profile",label:"/student/profile"},{value:"/student/faq",label:"/student/faq"},{value:"/student/about",label:"/student/about"},{value:"/logout",label:"/logout"}],_=[{value:"/admin/dashboard",label:"/admin/dashboard"},{value:"/admin/menu",label:"/admin/menu"},{value:"/admin/students",label:"/admin/students"},{value:"/admin/specimens",label:"/admin/specimens"},{value:"/admin/tests",label:"/admin/tests"},{value:"/admin/test-builder",label:"/admin/test-builder"},{value:"/admin/videos",label:"/admin/videos"},{value:"/admin/materials",label:"/admin/materials"},{value:"/admin/pyqs",label:"/admin/pyqs"},{value:"/admin/notifications",label:"/admin/notifications"},{value:"/admin/results",label:"/admin/results"},{value:"/admin/settings",label:"/admin/settings"},{value:"/logout",label:"/logout"}];function I(i){return i==="admin"?_:i==="both"?[...w,..._]:w}function R(){const{token:i}=k(),[p,C]=o.useState([]),[S,j]=o.useState(!0),[N,l]=o.useState(""),[r,T]=o.useState("student"),[s,d]=o.useState({id:null,name:"",route:"",icon:"ðŸ“„",type:"student",status:"active",menu_order:0}),x=o.useMemo(()=>{const t=Array.isArray(p)?p:[];return[...r?t.filter(n=>n.type===r||n.type==="both"):t].sort((n,u)=>Number(n.menu_order)-Number(u.menu_order)||Number(n.id)-Number(u.id))},[p,r]);async function c(){l(""),j(!0);try{const t=await h(`/api/admin/menu?type=${encodeURIComponent(r)}`,{token:i});C(Array.isArray(t==null?void 0:t.menus)?t.menus:[])}catch(t){l((t==null?void 0:t.message)||"Failed to load menus")}finally{j(!1)}}o.useEffect(()=>{c()},[r]);function b(){d({id:null,name:"",route:"",icon:"ðŸ“„",type:r||"student",status:"active",menu_order:0})}async function E(t){t.preventDefault(),l("");try{if(!s.name.trim()){l("Menu name is required");return}s.id?await h(`/api/admin/menu/${s.id}`,{token:i,method:"PUT",body:{name:s.name,route:s.route,icon:s.icon,type:s.type,status:s.status,menu_order:Number(s.menu_order)||0}}):await h("/api/admin/menu",{token:i,method:"POST",body:{name:s.name,route:s.route,icon:s.icon,type:s.type,status:s.status,menu_order:Number(s.menu_order)||0}}),b(),await c()}catch(a){l((a==null?void 0:a.message)||"Failed to save menu")}}function M(t){d({id:t.id,name:t.name||"",route:t.route||"",icon:t.icon||"ðŸ“„",type:t.type||"student",status:t.status||"active",menu_order:Number(t.menu_order)||0})}async function A(t){if(!(!(t!=null&&t.id)||!window.confirm(`Delete menu "${t.name}"?`))){l("");try{await h(`/api/admin/menu/${t.id}`,{token:i,method:"DELETE"}),await c()}catch(n){l((n==null?void 0:n.message)||"Failed to delete menu")}}}async function y(t,a){const n=x,u=n.findIndex(m=>m.id===t);if(u<0)return;const v=a==="up"?u-1:u+1;if(v<0||v>=n.length)return;const f=n[u],g=n[v],O=[{id:f.id,menu_order:Number(g.menu_order)||0},{id:g.id,menu_order:Number(f.menu_order)||0}];l("");try{await h("/api/admin/menu/reorder",{token:i,method:"PUT",body:{orders:O}}),await c()}catch(m){l((m==null?void 0:m.message)||"Failed to reorder")}}return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Menu Management"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"input",value:r,onChange:t=>{T(t.target.value),b()},children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"both",children:"Both"})]}),e.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>c(),children:"Refresh"})]})]})}),e.jsxs("div",{className:"card-body",children:[N?e.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-3 text-sm text-red-700",children:N}):null,e.jsxs("form",{onSubmit:E,className:"grid gap-3 md:grid-cols-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Menu name"}),e.jsx("input",{className:"input w-full",value:s.name,onChange:t=>d(a=>({...a,name:t.target.value})),placeholder:"e.g. Videos"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Route"}),e.jsxs("select",{className:"input w-full",value:s.route,onChange:t=>d(a=>({...a,route:t.target.value})),children:[e.jsx("option",{value:"",children:"Select route"}),I(s.type).map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Icon"}),e.jsx("select",{className:"input w-full",value:s.icon,onChange:t=>d(a=>({...a,icon:t.target.value})),children:F.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Order"}),e.jsx("input",{type:"number",className:"input w-full",value:s.menu_order,onChange:t=>d(a=>({...a,menu_order:t.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Type"}),e.jsxs("select",{className:"input w-full",value:s.type,onChange:t=>d(a=>({...a,type:t.target.value})),children:[e.jsx("option",{value:"student",children:"Student"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-600",children:"Status"}),e.jsxs("select",{className:"input w-full",value:s.status,onChange:t=>d(a=>({...a,status:t.target.value})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-6 flex items-center gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:s.id?"Update":"Add"}),e.jsx("button",{type:"button",className:"btn-ghost",onClick:b,children:"Clear"})]})]}),e.jsx("div",{className:"mt-6",children:S?e.jsx("div",{className:"text-sm text-slate-600",children:"Loading menus..."}):x.length===0?e.jsx("div",{className:"text-sm text-slate-600",children:"No menus found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b text-left text-slate-600",children:[e.jsx("th",{className:"py-2 pr-4",children:"Order"}),e.jsx("th",{className:"py-2 pr-4",children:"Name"}),e.jsx("th",{className:"py-2 pr-4",children:"Route"}),e.jsx("th",{className:"py-2 pr-4",children:"Icon"}),e.jsx("th",{className:"py-2 pr-4",children:"Type"}),e.jsx("th",{className:"py-2 pr-4",children:"Status"}),e.jsx("th",{className:"py-2 pr-4",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(t=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2 pr-4",children:t.menu_order}),e.jsx("td",{className:"py-2 pr-4 font-medium",children:t.name}),e.jsx("td",{className:"py-2 pr-4 text-slate-600",children:t.route}),e.jsx("td",{className:"py-2 pr-4",children:t.icon}),e.jsx("td",{className:"py-2 pr-4",children:t.type}),e.jsx("td",{className:"py-2 pr-4",children:t.status}),e.jsx("td",{className:"py-2 pr-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>y(t.id,"up"),children:"Up"}),e.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>y(t.id,"down"),children:"Down"}),e.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>M(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>A(t),children:"Delete"})]})})]},t.id))})]})})})]})]})})}export{R as default};
